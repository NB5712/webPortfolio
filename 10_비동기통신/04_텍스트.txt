<!DOCTYPE html>
<html lang="ko">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>api 연습</title>
  <style>
    /* reset */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      a { text-decoration: none; color: inherit; }

      /* wrap */
      #wrap { width: 90%; margin: 20px auto; }
      #wrap h1 { margin-bottom: 30px; }
      #new { display: flex; flex-wrap: wrap; justify-content: space-between; }
      .box { width: 300px; text-align: center; margin: 20px auto; padding: 15px 30px; border-radius: 4px; border: 1px solid #ddd; box-shadow: 4px 4px 4px #eee; }
      .box h2 { margin-bottom: 20px; }
      .box h3 { color: #333; }
      .box h3:hover { text-decoration: underline; }
      .box h4 { font-weight: normal; font-size: 14px; margin-bottom: 20px; }
      .box p { font-size: 12px; color: #666; text-align: left; }
      .box p:hover { text-decoration: underline; }
  </style>
</head>

<body>
  <div id="wrap">
    <h1>도서 API</h1>
    <h2>신간도서</h2>
    <div id="new">
    </div><!-- new -->
  </div><!-- wrap -->
  <script src="js/jquery-3.1.1.min.js"></script>
  <script>
    $.ajax({
      method: "GET",
      url: "https://dapi.kakao.com/v3/search/book?target=title",
      data: { query: "자바스크립트", size: 10 },
      headers: { Authorization: "KakaoAK RESTAPI키" },
    })
    .done(function (res) {
      // Kakao API의 응답 객체에서 'documents' 배열 추출
      const docs = res.documents;

      // 응답받은 문서(docs) 배열의 길이만큼 반복
      for (let i = 0; i < docs.length; i++) {
        // 현재 순서의 도서 정보를 book 변수에 할당
        const book = docs[i];
        // 책 설명(contents)에서 앞의 60자만 잘라서 summary에 저장
        const summary = book.contents.substring(0, 60);

        // jQuery로 <div class="box"> 요소를 생성하고,
        // 그 안에 책 정보를 담은 HTML 구조를 추가
        const $box = $('<div class="box"></div>').html(`
          <a href="sub.html">
            <img src="${book.thumbnail}" alt="썸네일">
            <h3>${book.title}</h3>
            <h4>${book.authors}</h4>
            <p>${summary}</p>
          </a>
        `);

        // 생성한 .box 요소를 #new 요소 내부에 추가
        $('#new').append($box);
      }
    })
    .fail(function () {
      // 요청이 실패했을 때 실행
      console.error('실패');
    })
    .always(function () {
      // 성공이든 실패든 항상 실행
      console.log('AJAX 요청이 완료되었습니다.');
    });
  </script>
</body>

</html>