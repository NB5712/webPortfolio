<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>restAPI-로컬스토리지</title>
    <style>
      /* reset */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      a { text-decoration: none; color: inherit; }

      /* wrap */
      #wrap { width: 90%; margin: 20px auto; }
      #wrap h1 { margin-bottom: 30px; }
      #new { display: flex; flex-wrap: wrap; justify-content: space-between;}
      .box { width: 300px; text-align: center; margin: 20px auto; padding: 15px 30px; border-radius: 4px; border: 1px solid #ddd; box-shadow: 4px 4px 4px #eee; }
      .box a { display: block; }
      .box h3 { color: #333; }
      .box h3:hover { text-decoration: underline; }
      .box h4 { font-weight: normal; font-size: 14px; margin-bottom: 20px; }
      .box p { font-size: 12px; color: #666; text-align: left; }
      .box p:hover { text-decoration: underline; }
      .btn { margin-top: 20px; display: inline-block; padding: 2px 10px; 
        border: solid 3px currentColor; border-radius: 6px; background-color: #a7a37e; color: #fff; font-size: 12px; }
      .btn:hover { background-color: #333; }
    </style>
  </head>

  <body>
    <div id="wrap">
      <h1>도서 API</h1>
      <h2>신간도서</h2>
      <div id="new">
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
      </div><!-- new -->
    </div><!-- wrap -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script>
      $.ajax({
        method: "GET",
        url: "https://dapi.kakao.com/v3/search/book?target=title",
        data: { query: "자바스크립트", size: 50 }, // 미움받을 용기
        headers: { Authorization: "KakaoAK 4260fe92da1b367f98ab4e9f47d041c6" },
      }).done(function (res) {
        console.log(res);
        const books = res.documents;
        console.log(books);
        console.log(books[1].title);
        console.log(books[1].thumbnail);

        // for문 (8개)
        const boxs = document.getElementsByClassName("box");

        for (let i = 0; i < boxs.length; i++) {
          const book = books[i];
          const str = book.contents;
          const str2 = str.substring(0, 60);

          $(".box").eq(i).append(`
              <a href="detail.html" class="book-link" data-index="${i}">
                <img src="${book.thumbnail}" alt="썸네일">
                <h3>${book.title}</h3>
                <h4>${book.authors}</h4>
                <p>${str2}...</p>
              </a>
            `);
        }

        // 클릭 이벤트: 해당 책 정보를 localStorage에 저장
        $(document).on("click", ".book-link", function () {
          const index = $(this).data("index");
          const bookData = books[index];
          localStorage.setItem("selectedBook", JSON.stringify(bookData));
        });
      });
    </script>
  </body>
</html>